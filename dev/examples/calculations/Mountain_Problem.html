
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Mountain Problem &#8212; MetPy 1.4dev</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme-unidata.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/doc_shared.js"></script>
    <link rel="shortcut icon" href="../../_static/metpy_32x32.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Bulk Shear" href="Bulk_Shear.html" />
    <link rel="prev" title="Mean Pressure Weighted" href="Mean_Pressure_Weighted.html" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-92978945-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

    <link rel="canonical" href="https://unidata.github.io/MetPy/latest/examples/calculations/Mountain_Problem.html" />

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
  <nav class="navbar navbar-dark navbar-expand-lg bg-unidata fixed-top bd-navbar shadow" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/metpy_horizontal.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../userguide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api/index.html">
  Reference Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../devel/index.html">
  Developer’s Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Example Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../userguide/SUPPORT.html">
  Support
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/Unidata/MetPy/releases">Release Notes<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/Unidata/MetPy" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/MetPy" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
  </nav>


    <div class="container-fluid" id="banner"></div>


    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
  Version 1.4dev
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown" id="version-menu"></div><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../XArray_Projections.html">
   XArray Projection Handling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sigma_to_pressure_interpolation.html">
   Sigma to Pressure Interpolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Advanced_Sounding.html">
   Advanced Sounding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cross_section.html">
   Cross Section Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Four_Panel_Map.html">
   Four Panel Map
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../isentropic_example.html">
   Isentropic Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../meteogram_metpy.html">
   Meteogram
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Calculations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Parse_Angles.html">
     Parse angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Dewpoint_and_Mixing_Ratio.html">
     Dewpoint and Mixing Ratio
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Angle_to_Direction.html">
     Angle to Direction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Wind_Speed.html">
     Wind Speed
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Divergence.html">
     Divergence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Vorticity.html">
     Vorticity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Absolute_Vorticity.html">
     Absolute Vorticity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Total_Deformation.html">
     Total Deformation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Shearing_Deformation.html">
     Shearing Deformation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Stretching_Deformation.html">
     Stretching Deformation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Static_Stability.html">
     Static Stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Mean_Pressure_Weighted.html">
     Mean Pressure Weighted
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Mountain Problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Bulk_Shear.html">
     Bulk Shear
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Thickness_Hydrostatic.html">
     Hydrostatic Thickness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Equivalent_Potential_Temperature.html">
     Equivalent Potential Temperature
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Advection.html">
     Advection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Gradient.html">
     Gradient
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="QVector.html">
     Q-Vector
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Smoothing.html">
     Smoothing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Sounding_Calculations.html">
     Sounding Calculation Examples
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../formats/index.html">
   File Formats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../formats/GINI_Water_Vapor.html">
     GINI Water Vapor Imagery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../formats/NEXRAD_Level_3_File.html">
     NEXRAD Level 3 File
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../formats/NEXRAD_Level_2_File.html">
     NEXRAD Level 2 File
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../gridding/index.html">
   Gridding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../gridding/Find_Natural_Neighbors_Verification.html">
     Find Natural Neighbors Verification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gridding/Wind_SLP_Interpolation.html">
     Wind and Sea Level Pressure Interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gridding/Point_Interpolation.html">
     Point Interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gridding/Inverse_Distance_Verification.html">
     Inverse Distance Verification: Cressman and Barnes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gridding/Natural_Neighbor_Verification.html">
     Natural Neighbor Verification
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../plots/index.html">
   Plotting
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/Simplified_Image_Plot.html">
     Simple Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/US_Counties.html">
     US Counties
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/raster_declarative.html">
     Raster Plots using Declarative Syntax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/Simple_Fronts_Plot.html">
     Simple Plotting of Fronts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/spc_convective_outlook.html">
     NOAA SPC Convective Outlook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/Combined_plotting.html">
     Combined Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/surface_declarative.html">
     Surface Analysis using Declarative Syntax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/upperair_declarative.html">
     Upper Air Analysis using Declarative Syntax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/nhc_wind_probabilities.html">
     NOAA NHC Wind Speed Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/Skew-T_Layout.html">
     Skew-T with Complex Layout
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/Hodograph_Inset.html">
     Hodograph Inset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/Sounding_LCL_Dataset.html">
     Sounding as Dataset Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/Plotting_Surface_Analysis.html">
     Plotting Fronts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/Simple_Sounding.html">
     Simple Sounding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/Mesonet_Stationplot.html">
     Mesonet Station Plot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/Station_Plot.html">
     Station Plot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plots/Station_Plot_with_Layout.html">
     Station Plot with Layout
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-calculations-mountain-problem-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="mountain-problem">
<span id="sphx-glr-examples-calculations-mountain-problem-py"></span><h1>Mountain Problem<a class="headerlink" href="#mountain-problem" title="Permalink to this headline">#</a></h1>
<p>Use functions from <a class="reference internal" href="../../api/generated/metpy.calc.html#module-metpy.calc" title="metpy.calc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">metpy.calc</span></code></a> to perform calculations for a rising and sinking parcel.</p>
<p>The code below explores a common problem in meteorology where a parcel can be defined and
lifted initiatlly dry adibatically until saturation is reached. It then ascends moist
adiabatically to a desired level before descending back to the original level from which the
parcel started.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">metpy.calc</span> <span class="kn">import</span> <a href="../../api/generated/metpy.calc.dry_lapse.html#metpy.calc.dry_lapse" title="metpy.calc.dry_lapse" class="sphx-glr-backref-module-metpy-calc sphx-glr-backref-type-py-function"><span class="n">dry_lapse</span></a><span class="p">,</span> <a href="../../api/generated/metpy.calc.lcl.html#metpy.calc.lcl" title="metpy.calc.lcl" class="sphx-glr-backref-module-metpy-calc sphx-glr-backref-type-py-function"><span class="n">lcl</span></a><span class="p">,</span> <a href="../../api/generated/metpy.calc.moist_lapse.html#metpy.calc.moist_lapse" title="metpy.calc.moist_lapse" class="sphx-glr-backref-module-metpy-calc sphx-glr-backref-type-py-function"><span class="n">moist_lapse</span></a>
<span class="kn">from</span> <span class="nn">metpy.units</span> <span class="kn">import</span> <span class="n">units</span>
</pre></div>
</div>
<p>To set up the classic mountain problem, let’s define that the parcel will start at 1000-hPa
and ascend to 700-hPa with an initial temperature of 25 Celsius and a dewpoint of 10 Celsius</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">301</span><span class="p">)</span> <span class="o">*</span> <a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Unit" title="pint.util.Unit" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">units</span><span class="o">.</span><span class="n">hPa</span></a>
<a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">T</span></a> <span class="o">=</span> <span class="mi">25</span> <span class="o">*</span> <a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Unit" title="pint.util.Unit" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">units</span><span class="o">.</span><span class="n">degC</span></a>
<a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Td</span></a> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Unit" title="pint.util.Unit" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">units</span><span class="o">.</span><span class="n">degC</span></a>
</pre></div>
</div>
<p>We first need to determine the maximum level of dry ascent. For this we can use the LCL
function and retain the pressure level and temperature of the parcel at the LCL</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lclp</span></a><span class="p">,</span> <a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lclt</span></a> <span class="o">=</span> <a href="../../api/generated/metpy.calc.lcl.html#metpy.calc.lcl" title="metpy.calc.lcl" class="sphx-glr-backref-module-metpy-calc sphx-glr-backref-type-py-function"><span class="n">lcl</span></a><span class="p">(</span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">T</span></a><span class="p">,</span> <a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Td</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Initial dry ascent yields:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  LCL Pressure: </span><span class="si">{</span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lclp</span></a><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  LCL Temperature: </span><span class="si">{</span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lclt</span></a><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Initial dry ascent yields:
  LCL Pressure: 801.54 hectopascal
  LCL Temperature: 6.74 degree_Celsius
</pre></div>
</div>
<p>Knowing that the calculation of the dry ascent is accomplished by the LCL calculation, we
know how to begin our moist ascent. Begin by subsetting the pressure to begin at levels
less than or equal to the LCL pressure and use the moist_lapse to find the temperature
at the top of our ascent (700-hPa in our case)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moist_ascent_p</span></a> <span class="o">=</span> <a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p</span></a><span class="p">[</span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p</span></a> <span class="o">&lt;=</span> <a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lclp</span></a><span class="p">]</span>
<a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moist_ascent_t</span></a> <span class="o">=</span> <a href="../../api/generated/metpy.calc.moist_lapse.html#metpy.calc.moist_lapse" title="metpy.calc.moist_lapse" class="sphx-glr-backref-module-metpy-calc sphx-glr-backref-type-py-function"><span class="n">moist_lapse</span></a><span class="p">(</span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moist_ascent_p</span></a><span class="p">,</span> <a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lclt</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After moist ascent:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  Temperature at top of ascent: </span><span class="si">{</span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moist_ascent_t</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>After moist ascent:
  Temperature at top of ascent: 0.82 degree_Celsius
</pre></div>
</div>
<p>Now to come “down the mountain” our parcel will warm dry adiabatically, so we can use the
dry_laspe function to descend from the lowest pressure (using [::-1] to reverse the order)
and convert our solution to Celsius</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dry_descent</span></a> <span class="o">=</span> <a href="../../api/generated/metpy.calc.dry_lapse.html#metpy.calc.dry_lapse" title="metpy.calc.dry_lapse" class="sphx-glr-backref-module-metpy-calc sphx-glr-backref-type-py-function"><span class="n">dry_lapse</span></a><span class="p">(</span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p</span></a><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moist_ascent_t</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Pulling it all together</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting Temperature: </span><span class="si">{</span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">T</span></a><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting Dewpoint: </span><span class="si">{</span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Td</span></a><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Final Temperature: </span><span class="si">{</span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dry_descent</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Final Dewpoint: </span><span class="si">{</span><a href="https://pint.readthedocs.io/en/stable/api/base.html#pint.Quantity" title="pint.util.Quantity" class="sphx-glr-backref-module-pint-util sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moist_ascent_t</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Starting Temperature: 25.00 degree_Celsius
Starting Dewpoint: 10.00 degree_Celsius

Final Temperature: 30.21 degree_Celsius
Final Dewpoint: 0.82 degree_Celsius
</pre></div>
</div>
<p>So as we expect the parcel has warmed and dried out through the combined dry and moist ascent
due to the release of latent heat and subsequent precipitating out of moisture from the
parcel</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.014 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-calculations-mountain-problem-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/6688ad0930b244cc7be1389afffafff6/Mountain_Problem.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">Mountain_Problem.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/6bc61c84bcb5f6be53fe66708fe85106/Mountain_Problem.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">Mountain_Problem.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Mean_Pressure_Weighted.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Pressure Weighted</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Bulk_Shear.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Bulk Shear</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2008–2023, MetPy Developers.Development is supported by Unidata and the National Science Foundation..<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>